import{d as x,_ as C,c as f,j as E,m as S,e as k,k as L,g as c,g5 as $,w as u,i as b,h,aj as T}from"./index-b9c76e4f.js";const B={mounted(o,t){t.value&&_(o)},updated(o,t){t.value?_(o):p(o)},beforeUnmount(o){p(o)}};async function _(o){await v();const t=o.querySelector(".el-dialog");if(!t)return;const a=o.querySelector(".el-dialog__header"),n=o.querySelector(".el-overlay");n.style.cssText+="overflow: hidden;",a.style.cursor="move";let d=!1,e={window:{width:0,height:0},dialog:{x:0,y:0,width:0,height:0,marginTop:""},mouse:{x:0,y:0},drag:{x:0,y:0}};a.addEventListener("mousedown",r),document.addEventListener("mousemove",l),document.addEventListener("mouseup",g),window.addEventListener("resize",w);function s(){e.mouse.x-e.drag.x>=e.dialog.x&&(e.drag.x=e.mouse.x-e.dialog.x),e.drag.x-e.mouse.x>=e.window.width-(e.dialog.x+e.dialog.width)&&(e.drag.x=e.mouse.x+e.window.width-e.dialog.x-e.dialog.width),e.mouse.y-e.drag.y>=e.dialog.y&&(e.drag.y=e.mouse.y-e.dialog.y),e.drag.y-e.mouse.y>=e.window.height-(e.dialog.y+e.dialog.height)&&(e.drag.y=e.mouse.y+e.window.height-e.dialog.y-e.dialog.height),m()}function m(){let i=e.drag.y-e.mouse.y+e.dialog.y,y=e.drag.x-e.mouse.x+e.dialog.x;t.style.cssText+=`position: absolute; top: calc(${i}px - ${e.dialog.marginTop}); left: ${y}px;`}function r(i){i.button===0&&(e.window={width:document.body.clientWidth,height:document.body.clientHeight},e.dialog=t.getBoundingClientRect(),e.dialog.marginTop=window.getComputedStyle(t).marginTop,e.mouse={x:i.clientX,y:i.clientY},d=!0)}function l(i){d&&(e.drag={x:i.clientX,y:i.clientY},n.style.userSelect="none",s())}function g(i){n.style.userSelect="auto",d=!1}function w(i){}function v(){return new Promise((i,y)=>{setTimeout(()=>{i()},500)})}o.__mouseDown__=r,o.__mouseUp__=g,o.__mouseMove__=l,o.__sizeChange__=w}function p(o){document.removeEventListener("mousedown",o.__mouseDown__),document.removeEventListener("mousemove",o.__mouseMove__),document.removeEventListener("mouseup",o.__mouseUp__),window.removeEventListener("resize",o.__sizeChange__)}const D=B,V=x({props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!1}),required:!0}},directives:{drag:D},setup(o,t){function a(){t.emit("confirm")}function n(){o.layer.show=!1}return{confirm:a,close:n}}});function z(o,t,a,n,d,e){const s=f("el-button"),m=f("el-dialog"),r=E("drag");return S((k(),L("div",null,[c(m,{modelValue:o.layer.show,"onUpdate:modelValue":t[0]||(t[0]=l=>o.layer.show=l),title:o.layer.title,width:o.layer.width,center:""},$({default:u(()=>[T(o.$slots,"default")]),_:2},[o.layer.showButton?{name:"footer",fn:u(()=>[b("div",null,[c(s,{type:"primary",onClick:o.confirm},{default:u(()=>[h("确认")]),_:1},8,["onClick"]),c(s,{onClick:o.close},{default:u(()=>[h("取消")]),_:1},8,["onClick"])])]),key:"0"}:void 0]),1032,["modelValue","title","width"])])),[[r,o.layer.show]])}const j=C(V,[["render",z]]);export{j as default};
